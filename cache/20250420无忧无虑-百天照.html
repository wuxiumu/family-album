<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Family Album-20250420Êó†ÂøßÊó†Ëôë-ÁôæÂ§©ÁÖß</title>
    <meta name="keywords" content="family, album, pictures, family pictures,20250420Êó†ÂøßÊó†Ëôë-ÁôæÂ§©ÁÖß">
    <meta name="description" content="Family album is a collection of family pictures,20250420Êó†ÂøßÊó†Ëôë-ÁôæÂ§©ÁÖß">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .fade-img-enter-active, .fade-img-leave-active {
            transition: all .7s cubic-bezier(.4,0,.2,1);
        }
        .fade-img-enter-from, .fade-img-leave-to {
            opacity: 0;
            transform: scale(1.08) rotateZ(-2deg);
        }
        .blur-bg {
            backdrop-filter: blur(16px) brightness(.7);
            -webkit-backdrop-filter: blur(16px) brightness(.7);
        }
    </style>
</head>
<body class="bg-gradient-to-tr from-rose-100 via-blue-50 to-yellow-100 min-h-screen">

<div id="app" class="w-full h-screen flex flex-col">
    <!-- È°∂ÈÉ® LOGO + ÊéßÂà∂Ê†è -->
    <div class="flex justify-between items-center px-12 pt-8 pb-3 gap-6">
        <h1 class="text-4xl font-bold text-pink-700 drop-shadow-lg flex items-center gap-2">
            <span class="text-2xl animate-bounce">‚ú®</span>
        </h1>
        <!-- Ê∏©È¶®Áü≠ËØ≠È°∂ÈÉ®ÂûÇÁõ¥Â±Ö‰∏≠ÔºàÁªùÂØπÂ±Ö‰∏≠Ôºâ -->
        <div class="flex gap-4">
            <div class="bg-white/70 backdrop-blur px-8 py-3 rounded-2xl text-2xl font-semibold text-pink-700 shadow-md animate-pulse">
                {{ currentDesc }}
            </div>
        </div>
        <div class="flex gap-4 items-center">
            <button @click="toggleAuto"
                    class="bg-blue-400 text-white px-5 py-2 rounded-2xl shadow hover:bg-blue-600 text-lg">
                {{ playing ? 'ÊöÇÂÅú' : 'Ëá™Âä®Êí≠Êîæ' }}
            </button>
            <div class="flex items-center gap-2 hidden">
                <span class="text-sm text-gray-500">OSSÂéãÁº©</span>
                <select v-model="ossParam" class="rounded-xl px-3 py-1 bg-white border border-gray-300 text-gray-700 shadow">
                    <option v-for="item in ossOptions" :value="item.value">{{ item.label }}</option>
                </select>
                <input v-if="ossParam==='CUSTOM'" v-model="customOssParam" class="rounded-xl px-2 py-1 w-56 text-xs border border-pink-200" placeholder="‰æãÂ¶Ç ?x-oss-process=image/resize,w_640/quality,q_90">
            </div>
        </div>
    </div>
    <!-- Â§ßÂõæÂπªÁÅØÁâáÂå∫ -->
    <div class="relative flex-1 flex items-center justify-center overflow-hidden">
        <!-- ËÉåÊôØÊ®°Á≥äÂ±Ç -->
        <div class="absolute inset-0 blur-bg z-0" :style="bgImgStyle"></div>
        <!-- ÂπªÁÅØÁâáÂ§ßÂõæÂä† loading Âä®ÁîªÂíåÊáíÂä†ËΩΩ -->
        <transition name="fade-img" mode="out-in">
            <a
                    :href="currentImg.link"
                    target="_blank"
                    style="display: inline-block;"
                    :key="currentImg.img+ossUrl(currentImg.img, finalOssParam)"
                    class="relative"
            >
                <img
                        :src="ossUrl(currentImg.img, finalOssParam)"
                        :alt="currentImg.desc"
                        class="max-h-[70vh] max-w-[80vw] rounded-[2.5rem] shadow-2xl z-10 border-8 border-white object-contain bg-white/40"
                        loading="lazy"
                        @load="imgLoading = false"
                        style="transition: filter .3s"
                        :style="{ filter: imgLoading ? 'blur(10px) brightness(0.85)' : 'none' }"
                />
                <div v-if="imgLoading"
                     class="absolute inset-0 flex items-center justify-center z-20">
                    <div class="w-16 h-16 border-4 border-pink-300 border-t-transparent rounded-full animate-spin"></div>
                </div>
            </a>
        </transition>
        <!-- Â∑¶Âè≥ÂàáÊç¢ÁÆ≠Â§¥ -->
        <button @click="prev"
                class="absolute left-4 top-1/2 -translate-y-1/2 text-4xl text-blue-500 hover:scale-125 transition z-20 select-none bg-white/40 rounded-full p-2 shadow-lg">
            ‚Äπ
        </button>
        <button @click="next"
                class="absolute right-4 top-1/2 -translate-y-1/2 text-4xl text-pink-500 hover:scale-125 transition z-20 select-none bg-white/40 rounded-full p-2 shadow-lg">
            ‚Ä∫
        </button>
        <!-- Ê∞îÁêÉÂΩ©Â∏¶Ë£ÖÈ•∞ -->
        <span class="absolute left-10 top-10 text-5xl animate-bounce z-30">üéà</span>
        <span class="absolute right-16 bottom-12 text-4xl animate-bounce delay-1000 z-30">üéâ</span>
    </div>
    <!-- Áº©Áï•ÂõæÊ®™Êéí -->
    <div class="w-full flex justify-center items-center gap-4 py-5 bg-white/60 shadow-inner overflow-x-auto">
        <div class="flex gap-4">
            <img
                    v-for="(img, idx) in images"
                    :key="img.img+ossUrl(img.img, finalOssParam)"
                    :src="ossUrl(img.img, finalOssParam)"
                    :alt="img.desc"
                    class="w-24 h-16 rounded-2xl object-cover border-4 cursor-pointer transition-all hover:scale-110"
                    :class="{'border-blue-500 ring-4 ring-pink-300': idx===currentIndex, 'border-white': idx!==currentIndex}"
                    @click="goto(idx)"
                    loading="lazy"
            />
        </div>
    </div>
</div>

<script>
    const { createApp, ref, computed, onMounted, watch } = Vue;
    const ossConfig = {
        defaultParam: "?x-oss-process=image/resize,w_1800/quality,q_100",
        options: [
            { label: "Êó†", value: "" },
            { label: "Ê†áÂáÜÔºà900ÂÆΩ/80Ë¥®ÈáèÔºâ", value: "?x-oss-process=image/resize,w_900/quality,q_80" },
            { label: "Âø´ÈÄüÔºà500ÂÆΩ/60Ë¥®ÈáèÔºâ", value: "?x-oss-process=image/resize,w_500/quality,q_60" },
            { label: "È´òÊ∏ÖÔºà1800ÂÆΩ/100Ë¥®ÈáèÔºâ", value: "?x-oss-process=image/resize,w_1800/quality,q_100" },
            { label: "Ëá™ÂÆö‰πâ", value: "CUSTOM" }
        ]
    };

    // mockÂºÇÊ≠•ËØ∑Ê±ÇÂõæÁâáÂàóË°®
    function fetchImages() {
        return new Promise(resolve => {
            setTimeout(() => {
                resolve(
                    [{"id":1,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A5981.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A5981.jpg","desc":"\u4f60\u753b\u7684\u5168\u5bb6\u798f\uff0c\u592a\u9633\u6c38\u8fdc\u5e26\u7740\u7b11\u8138\ud83c\udf1e"},{"id":2,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6077 2.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6077 2.jpg","desc":"\u6210\u957f\u662f\u68f5\u4f1a\u7ed3\u679c\u7684\u6811\uff0c\u6211\u4eec\u90fd\u662f\u6458\u679c\u5b50\u7684\u4eba\ud83c\udf4e"},{"id":3,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6083 2.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6083 2.jpg","desc":"\u54ed\u9f3b\u5b50\u65f6\u9012\u6765\u7684\u7eb8\u5dfe\uff0c\u6bd4\u4efb\u4f55\u793c\u7269\u90fd\u73cd\u8d35\ud83e\uddfb"},{"id":4,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6128.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6128.jpg","desc":"\u65e5\u5386\u6495\u5230\u6700\u540e\u4e00\u9875\u624d\u53d1\u73b0\uff0c\u611f\u52a8\u65e9\u628a\u7a7a\u767d\u586b\u6ee1\ud83d\udcc5"},{"id":5,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6148 2.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6148 2.jpg","desc":"\u7275\u624b\u8d70\u8fc7\u7684\u8def\uff0c\u8fde\u9752\u82d4\u90fd\u957f\u5f97\u7279\u522b\u6e29\u67d4\ud83c\udf3f"},{"id":6,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6159.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6159.jpg","desc":"\u7275\u624b\u8d70\u8fc7\u7684\u8def\uff0c\u8fde\u9752\u82d4\u90fd\u957f\u5f97\u7279\u522b\u6e29\u67d4\ud83c\udf3f"},{"id":7,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6234 2.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6234 2.jpg","desc":"\u4f60\u7684\u9152\u7a9d\u91cc\uff0c\u76db\u7740\u4e00\u6574\u4e2a\u6625\u5929\u7684\u751c\ud83c\udf76"},{"id":8,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6261.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6261.jpg","desc":"\u751f\u6d3b\u5076\u5c14\u4f1a\u505c\u7535\uff0c\u4f46\u4f60\u4eec\u6c38\u8fdc\u662f\u6211\u7684\u5907\u7528\u7535\u6e90\u26a1"},{"id":9,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6268.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6268.jpg","desc":"\u6210\u957f\u662f\u68f5\u4f1a\u7ed3\u679c\u7684\u6811\uff0c\u6211\u4eec\u90fd\u662f\u6458\u679c\u5b50\u7684\u4eba\ud83c\udf4e"},{"id":10,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6285.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6285.jpg","desc":"\u79ef\u6728\u642d\u6210\u7684\u57ce\u5821\u91cc\uff0c\u4f4f\u7740\u4e0d\u80af\u957f\u5927\u7684\u7ae5\u8bdd\ud83c\udff0"},{"id":11,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6319.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6319.jpg","desc":"\u9910\u684c\u7684\u706f\u5149\u4e0b\uff0c\u5520\u55d1\u58f0\u628a\u996d\u83dc\u70ed\u4e86\u53c8\u70ed\ud83c\udf7d\ufe0f"},{"id":12,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6321.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6321.jpg","desc":"\u665a\u996d\u540e\u7684\u6563\u6b65\u8def\uff0c\u6708\u5149\u628a\u6211\u4eec\u7684\u5f71\u5b50\u62c9\u6210\u4e86\u9ebb\u82b1\ud83d\udcab"},{"id":13,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6333.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6333.jpg","desc":"\u966a\u4f60\u957f\u5927\u7684\u65e5\u5b50\uff0c\u6211\u4e5f\u5077\u5077\u53d8\u52c7\u6562\u4e86\u2728"},{"id":14,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6358.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6358.jpg","desc":"\u665a\u996d\u540e\u7684\u6563\u6b65\u8def\uff0c\u6708\u5149\u628a\u6211\u4eec\u7684\u5f71\u5b50\u62c9\u6210\u4e86\u9ebb\u82b1\ud83d\udcab"},{"id":15,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6359.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6359.jpg","desc":"\u5c31\u7b97\u5168\u4e16\u754c\u4e0b\u96e8\uff0c\u6709\u4f60\u4eec\u5728\u5c31\u662f\u6674\u5929\ud83c\udf26\ufe0f\u2192\u2600\ufe0f"},{"id":16,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6363.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6363.jpg","desc":"\u90a3\u4e9b\u6ca1\u8bf4\u51fa\u53e3\u7684\u7231\uff0c\u90fd\u85cf\u5728\u7761\u524d\u7684 \u201c\u665a\u5b89\u201d \u91cc\ud83c\udf19"},{"id":17,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6372.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6372.jpg","desc":"\u4f60\u7684\u5b58\u5728\u672c\u8eab\uff0c\u5c31\u662f\u6211\u5bf9\u6297\u4e16\u754c\u7684\u52c7\u6c14\ud83d\udcaa"},{"id":18,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6381.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6381.jpg","desc":"\u65e5\u5386\u6495\u5230\u6700\u540e\u4e00\u9875\u624d\u53d1\u73b0\uff0c\u611f\u52a8\u65e9\u628a\u7a7a\u767d\u586b\u6ee1\ud83d\udcc5"},{"id":19,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6385.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6385.jpg","desc":"\u9910\u684c\u7684\u706f\u5149\u4e0b\uff0c\u5520\u55d1\u58f0\u628a\u996d\u83dc\u70ed\u4e86\u53c8\u70ed\ud83c\udf7d\ufe0f"},{"id":20,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6404.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6404.jpg","desc":"\u5435\u67b6\u540e\u5077\u5077\u585e\u8fdb\u6211\u53e3\u888b\u7684\u7cd6\uff0c\u751c\u5230\u4e86\u5fc3\u5c16\u5c16\ud83c\udf6c"},{"id":21,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6405.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6405.jpg","desc":"\u51b0\u7bb1\u91cc\u7684\u5269\u83dc\u996d\uff0c\u70ed\u4e00\u70ed\u8fd8\u662f\u5bb6\u7684\u5473\u9053\ud83c\udf5a"},{"id":22,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6407.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6407.jpg","desc":"\u5c31\u7b97\u5168\u4e16\u754c\u4e0b\u96e8\uff0c\u6709\u4f60\u4eec\u5728\u5c31\u662f\u6674\u5929\ud83c\udf26\ufe0f\u2192\u2600\ufe0f"},{"id":23,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6411.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6411.jpg","desc":"\u54ed\u9f3b\u5b50\u65f6\u9012\u6765\u7684\u7eb8\u5dfe\uff0c\u6bd4\u4efb\u4f55\u793c\u7269\u90fd\u73cd\u8d35\ud83e\uddfb"},{"id":24,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6414.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6414.jpg","desc":"\u665a\u996d\u540e\u7684\u6563\u6b65\u8def\uff0c\u6708\u5149\u628a\u6211\u4eec\u7684\u5f71\u5b50\u62c9\u6210\u4e86\u9ebb\u82b1\ud83d\udcab"},{"id":25,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6424.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6424.jpg","desc":"\u8001\u76f8\u518c\u91cc\u7684\u8936\u76b1\uff0c\u5168\u662f\u65f6\u5149\u543b\u8fc7\u7684\u75d5\u8ff9\ud83d\udcf8"},{"id":26,"url":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6426.jpg","img":"https:\/\/jiatingshiguangxiangce.oss-cn-beijing.aliyuncs.com\/20250420%E6%97%A0%E5%BF%A7%E6%97%A0%E8%99%91-%E7%99%BE%E5%A4%A9%E7%85%A7\/%E7%B2%BE%E4%BF%AE%E5%9B%BE\/8D7A6426.jpg","desc":"\u966a\u4f60\u957f\u5927\u7684\u65e5\u5b50\uff0c\u6211\u4e5f\u5077\u5077\u53d8\u52c7\u6562\u4e86\u2728"}]
                );
            }, 300);
        });
    }

    // Ê£ÄÊü•ÂçïÂº†ÂõæÁâáËÉΩÂê¶Âä†ËΩΩÔºåËøîÂõû Promise<boolean>
    function checkImage(url) {
        return new Promise(resolve => {
            const img = new window.Image();
            img.onload = () => resolve(true);
            img.onerror = () => resolve(false);
            img.src = url;
        });
    }

    // ÊãºÊé• OSS ÂèÇÊï∞
    function ossUrl(url, param) {
        url = decodeURIComponent(url);
        if (!url) return '';
        if (url.includes("?x-oss-process")) return url;
        return url + (param || "");
    }

    createApp({
        setup() {
            const images = ref([]);
            const lostImages = ref([]);
            const ossParam = ref(ossConfig.defaultParam);
            const ossOptions = ossConfig.options;
            const customOssParam = ref("");
            const imgLoading = ref(true);
            const currentIndex = ref(0);
            const playing = ref(true);
            const timer = ref(null);

            // ÂΩìÂâçOSSÊúÄÁªàÂèÇÊï∞
            const finalOssParam = computed(() => {
                if (ossParam.value === "CUSTOM") {
                    let str = customOssParam.value.trim();
                    if (!str) return "";
                    if (str[0] !== "?") str = "?" + str;
                    return str;
                }
                return ossParam.value;
            });

            // Áî®‰∫éÈáçÊñ∞Ê£ÄÊµãÂÖ®ÈÉ®ÂõæÁâáÔºàÂéãÁº©ÂèÇÊï∞Âèò‰∫ÜÂèØÈáçÊñ∞ÊâπÈáèÊ£ÄÊµãÔºâ
            async function filterValidImages(list) {
                let valid = [];
                let invalid = [];
                let promises = list.map(async img => {
                    const url = ossUrl(img.img, finalOssParam.value);
                    const ok = await checkImage(url);
                    if (ok) {
                        valid.push(img);
                    } else {
                        invalid.push(img);
                    }
                });
                await Promise.all(promises);
                images.value = valid;
                lostImages.value = invalid;
                if (invalid.length > 0) {
                    console.warn("Êó†Ê≥ïÂä†ËΩΩÂõæÁâáÔºö");
                    invalid.forEach(item => console.warn(item.img));
                }
                console.log(`ÂÖ±${valid.length + invalid.length}Âº†ÂõæÁâáÔºåÂèØÁî®${valid.length}Âº†ÔºåÂ§±Êïà${invalid.length}Âº†`);
                // Á¥¢ÂºïÊ†°Ê≠£
                if (currentIndex.value >= valid.length) {
                    currentIndex.value = valid.length > 0 ? valid.length - 1 : 0;
                }
            }

            // ÂΩìÂâçÊòæÁ§∫ÂõæÁâá
            const currentImg = computed(() => images.value[currentIndex.value] || {});
            const currentDesc = computed(() => currentImg.value.desc || '');
            const bgImgStyle = computed(() => ({
                backgroundImage: currentImg.value.img ? `url(${ossUrl(currentImg.value.img, finalOssParam.value)})` : '',
                backgroundSize: 'cover',
                backgroundPosition: 'center',
                backgroundRepeat: 'no-repeat',
            }));

            // ÂπªÁÅØÁâáÂàáÊç¢
            function next() {
                currentIndex.value = (currentIndex.value + 1) % images.value.length;
            }
            function prev() {
                currentIndex.value = (currentIndex.value - 1 + images.value.length) % images.value.length;
            }
            function goto(idx) {
                currentIndex.value = idx;
            }
            function toggleAuto() {
                playing.value ? stopAuto() : startAuto();
            }
            function startAuto() {
                timer.value && clearInterval(timer.value);
                timer.value = setInterval(() => next(), 5000);
                playing.value = true;
            }
            function stopAuto() {
                timer.value && clearInterval(timer.value);
                playing.value = false;
            }

            // ÁõëÂê¨ÂèÇÊï∞ÂèòÂåñÈáçÊñ∞Ê£ÄÊµã
            watch(finalOssParam, () => {
                fetchImages().then(filterValidImages);
            });

            // È¶ñÊ¨°Âä†ËΩΩ
            onMounted(async () => {
                let list = await fetchImages();
                await filterValidImages(list);
                startAuto();
            });

            // ÈîÆÁõòÊìç‰Ωú
            function onKey(e) {
                if (e.code === 'ArrowLeft') prev();
                if (e.code === 'ArrowRight') next();
                if (e.code === 'Space') toggleAuto();
            }
            onMounted(() => {
                window.addEventListener('keydown', onKey);
            });

            // ÂπªÁÅØÁâáÂõæÁâáÊáíÂä†ËΩΩloadingÂä®Áîª
            watch([currentIndex, finalOssParam], () => {
                imgLoading.value = true;
                if (!playing.value) return;
                stopAuto(); startAuto();
            });

            return {
                images, lostImages, currentImg, currentDesc, currentIndex, playing,
                next, prev, goto, toggleAuto, bgImgStyle, imgLoading,
                ossParam, ossOptions, customOssParam, finalOssParam,
                ossUrl
            };
        }
    }).mount('#app');
</script>
</body>
</html>